# Test locally

To test locally using Docker compose perform the below steps:

1. Build a docker image with a given client:
   ```
   sbt kafka/docker:publishLocal
   ```
2. Prepare test settings, see `test-kafka.json`
3. Start docker (e.g. kafka command):
   ```
   docker-compose -f ../metrics/docker-compose.metrics.yml -f docker-compose.yml -p kafka up
   ```
   and wait for a bit before starting the test (i.e. it takes a few minutes to start Kafka)
4. Run the test `python run-local.py test-kafka.json` and wait till it finished
5. After shutting down Docker compose you can clear all the outstanding data using
   ```
   docker-compose -f ../metrics/docker-compose.metrics.yml -f docker-compose.yml -p kafka rm -svf
   ```

# Development

Use `test-grafana-snapshot.py` to test how saving Grafna dashboard snapshot is working, in folder `result` there is
`expected.json`, which a pyload generated by UI/browser when preparing snapshot, and there is `actual.json` - 
a json generated by the `grafana.py`. The both files should be similar. if somthing is totally different check
the dashboard definition on `MQPerj.json`
